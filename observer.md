# Шаблон разработки Observer

Шаблон разработки наблюдателя позволяет подписчику регистрироваться у поставщика и получать от него уведомления.
Он подходит для любого сценария, в котором требуется использование push-уведомлений.
Шаблон определяет поставщик (также называемый субъектом или наблюдаемым) и ноль, один или несколько наблюдателей.
Наблюдатели регистрируются у поставщика, и при возникновении предварительно заданного условия, события или изменения состояния поставщик автоматически уведомляет все наблюдатели путем вызова одного из их методов.
В вызове метода поставщик также может предоставить наблюдателям сведения о текущем состоянии.
В .NET конструктивный шаблон наблюдателя применяется путем реализации универсальных интерфейсов System.IObservable<T> и System.IObserver<T>.
Параметр универсального типа представляет тип, который предоставляет сведения об уведомлении.

## Применение шаблона

Шаблон разработки наблюдателя подходит для распределенных push-уведомлений, так как он поддерживает четкое разделение двух разных компонентов или уровней приложения, таких как уровень источника данных (бизнес-логика) и уровень пользовательского интерфейса (отображение).
Шаблон можно реализовывать во всех случаях, когда поставщик использует обратные вызовы для предоставления текущих сведений клиентам.

Для реализации шаблона необходимы перечисленные ниже элементы:

Поставщик или субъект, то есть объект, отправляющий уведомления наблюдателям.
Поставщик — это класс или структура, реализующие интерфейс IObservable<T>.
Поставщик должен реализовывать единственный метод, IObservable<T>.Subscribe, вызываемый наблюдателями, которым требуется получать уведомления от поставщика.

Наблюдатель, то есть объект, получающий уведомления от поставщика.
Наблюдатель — это класс или структура, реализующие интерфейс IObserver<T>.
Наблюдатель должен реализовывать три метода, которые вызываются поставщиком:

метод IObserver<T>.OnNext, предоставляющий наблюдателю новые или текущие сведения;

метод IObserver<T>.OnError, информирующий наблюдатель о том, что произошла ошибка;

метод IObserver<T>.OnCompleted, указывающий, что поставщик завершил отправку уведомлений.

Механизм, который позволяет поставщику отслеживать наблюдатели.
Как правило, поставщик использует объект контейнера, например объект System.Collections.Generic.List<T>, для хранения ссылок на реализации IObserver<T>, которые подписаны на уведомления.
Использование контейнера хранилища в этих целях позволяет поставщику обрабатывать от нуля до неограниченного числа наблюдателей.
Порядок, в котором наблюдатели получают уведомления, не определен.
Поставщик может использовать любой метод для определения порядка.

Реализация IDisposable, которая позволяет поставщику удалять наблюдатели по завершении уведомления.
Наблюдатели получают ссылку на реализацию IDisposable из метода Subscribe, поэтому они также могут вызывать метод IDisposable.Dispose, чтобы отменить подписку, прежде чем поставщик завершит отправку уведомлений.

Объект, содержащий данные, которые поставщик отправляет своим наблюдателям.
Тип этого объекта соответствует параметру универсального типа интерфейсов IObservable<T> и IObserver<T>.
Несмотря на то что этот объект может совпадать с реализацией IObservable<T>, чаще всего это отдельный тип.
